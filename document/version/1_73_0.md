# Boost 1.73.0リリースノート

本家リリースノート：

- <https://github.com/boostorg/website/blob/master/feed/history/boost_1_73_0.qbk>
- <http://www.boost.org/users/history/version_1_73_0.html>


リポジトリは以下：

- <https://github.com/boostorg/>


リポジトリからのビルド方法は、egtraさんのブログを参照：

- 「[Modularized Boost（GitHubへ移行したリポジトリ）を使用する](http://dev.activebasic.com/egtra/2013/12/03/620/)」


## 新ライブラリ

- [Nowide](https://www.boost.org/libs/nowide/)
    - Windowsで標準ライブラリと組み合わせて使用するUTF-8 API (作者Artyom Beilis)


## 更新ライブラリ

- [Any](#any)
- [Assert](#assert)
- [Beast](#beast)
- [Context](#context)
- [Conversion](#conversion)
- [Flyweight](#flyweight)
- [LexicalCast](#lexical-cast)
- [Mp11](#mp11)
- [Multi-index](#multi-index)
- [Outcome](#outcome)
- [PolyCollection](#poly-collection)
- [ThrowException](#throw-exception)
- [Variant2](#variant2)


## 更新ツール

- [B2](#b2)


## <a id="any" href="#any">Any</a>

- `<algorithm>`をインクルードしないことでコンパイル速度を向上
- CI強化を含むメンテナンス作業


## <a id="assert" href="#assert">Assert</a>

- `source_location`クラスを追加


## <a id="beast" href="#beast">Beast</a>

- 今回はメンテナンスアップデートとなる
- Beast dynamic buffers内の入れ小型`mutable_data_type`を非推奨化した。代わりに`mutable_buffers_type`を使用するか`BOOST_BEAST_ALLOW_DEPRECATED`をdefineすること。影響を受ける型は以下：
    - `buffers_adaptor`
    - `flat_buffer`
    - `flat_static_buffer`
    - `multi_buffer`
    - `static_buffer`
- このライブラリを使用しているユーザーもしくはユーザー企業がどのようにこのライブラリを使用しているか教えてほしい。以下にリストがある：
    - [Companies and Individuals Using Beast](https://github.com/boostorg/beast/wiki/Companies-and-Individuals-Using-Beast)
- 雑多な修正
    - ルート証明の例を更新
- 修正
    - Content-Lengthの解析を修正
    - `buffer_bytes`のドキュメントを正した
    - strandにディスパッチする例を修正
    - `basic_stream::close`が例外を投げないことを保証
    - sha1.hpp内のインクルード漏れを修正
    - `ostream`の警告を修正
    - field digestはエンディアン非依存
    - README内のリンク切れを修正
    - `ostream`のフラッシュを修正
    - いくつかのWin32エラーをネットワークエラーコードに修正
    - `flat_buffer::shrink_to_fit`を`noexcept`にした
    - eraseフィールドを修正
    - コンパイル設定のドキュメントを修正
    - strandを使用する例を正した
    - `File:read`でのend-of-fileの動作をドキュメントで明確にした
    - `file_body`がeofの読み込み時に`short_read`を返すようにした
    - Win32での`file_body`のバグを修正
    - `ostream_buffer`が`DynamicBuffer_v1::commit`の事前条件を満たすようにした
    - `basic_file_body`のFileメンバにアクセッサ関数を追加
    - リリースビルドのドキュメントを修正
    - `file_win32`がUTF-8パスをサポート
    - `file_stdio`がUnicodeパスをサポート
    - `echo-op`のテストを修正
    - `file_win32`のボディが`http::serializer::split`を尊重するようにした
    - 非MSVCのcmakeを修正


## <a id="context" href="#context">Context</a>

- [GitHub #133](https://github.com/boostorg/context/pull/133) IBM Zのfcontextルーチンを修正
- [GitHub #132](https://github.com/boostorg/context/pull/132) mips64/n64のalignを2から3に修正
- [GitHub #131](https://github.com/boostorg/context/pull/131) OSプラットフォームとしてMIPS32とMIPS64で異なるABIを使用するようにした
- [GitHub #129](https://github.com/boostorg/context/pull/129) RISC-Vアセンブリのnon-PICを修正


## <a id="conversion" href="#conversion">Conversion</a>

- 参照用の`boost::polymorphic_downcast`を追加 (Julien Delacroix氏のパッチに感謝)
- 重大なドキュメント更新


## <a id="flyweight" href="#flyweight">Flyweight</a>

- メンテナンス上の修正


## <a id="lexical-cast" href="#lexical-cast">LexicalCast</a>

- [GitHub #31](https://github.com/boostorg/lexical_cast/pull/31), [GitHub #32](https://github.com/boostorg/lexical_cast/pull/32) CI強化と壊れた標準ライブラリへのワークアラウンドを含むメンテナンス作業 (Nikita Kniazev氏に感謝)


## <a id="mp11" href="#mp11">Mp11</a>

- `mp_unique_if`を追加 (Kris Jusiak氏による貢献)
- `mp_flatten`を追加
- `mp_rotate_left`, `mp_rotate_right`を追加 (Duncan Barber氏による貢献)
- `mp_compose`を追加
- `mp_power_set`を追加
- `mp_partial_sum`を追加
- `mp_iterate`を追加


## <a id="multi-index" href="#multi-index">Multi-index</a>

- `multi_index_container`を[アロケータの状態を伝播する](ttps://en.cppreference.com/w/cpp/named_req/AllocatorAwareContainer)ようにした
- [GitHub #29](https://github.com/boostorg/multi_index/issues/29) `[[swappable.requirements]]`の標準仕様に従って、`KeyFromValue`、`Compare`、`Hash`、`Pred`の内部オブジェクトをswapする際に、`std::swap`とADLによって見つかる`swap`で適切に選択するようにした
- 一部のコンパイラで警告が起きていた、C++11で非推奨となったデフォルトで暗黙定義される内部的なコピーコンストラクタと代入演算子のいくつかを、提供するようにした
- メンテナンス上の修正


## <a id="outcome" href="#outcome">Outcome</a>

- 強化
    - ClangでコンパイルされたOutcomeベースのコードのパフォーマンスを大幅に改善した。以前の実装では状態ビットフィールドでClangのオプティマイザが混乱し、低品質のコード生成が行われてしまっていた。多くのコード生成の問題とは異なり、[P1886 Error speed benchmarking](https://wg21.link/P1886)で示された、現実的なコードでの経験的なベンチマークで判明した
    - Outcome v2.2.0の将来的な機能として予定していた[`better_optimisation`ブランチ (より良い最適化)](https://github.com/ned14/outcome/tree/better_optimisation)のうち安全な部分を、Outcome v2.1.3にマージした。これには新たな状態ビットフィールドの実装も含まれる。これはClangのオプティマイザを混乱させないためのものであり、Clang 9はさまざまなユースケースでGCC 9を上回るコードを生成するようになった
    - インストールできることをコミットの度にCIでテストするようにした。スタンドアロン版のOutcomeのインストール (たとえば`make install`) は理想よりも頻繁に壊れるので、コミットごとにCIでテストするようにした
- バグ修正
    - [GitHub #214](https://github.com/ned14/outcome/issues/214) 新たなコンセプトを実装するコンパイラは`T`と`E`の破棄性を早期にチェックしてしまうことが不満だったため、テンプレート制約を削除し、型のインスタンス化シーケンスの後半で実行されるstatic assertにフォールバックするようにした
    - [GitHub #220](https://github.com/ned14/outcome/issues/220) Undefined Behaviour Sanitiserがいくつかの実験的なOutcome機能のユースケースで誤検知してしまうため、ワークアラウンドを入れた


## <a id="poly-collection" href="#poly-collection">PolyCollection</a>

- `boost::poly_collection::for_each`内での潜在的なムーブの警告を修正
- 状態を伝播しない非等値なアロケータにおける、アロケータ拡張のムーブ構築とムーブ代入で、要素がムーブではなくコピーされてしまう問題を修正
- GCC 4.8の同梱される古いバージョンのlibstdc++-v3において、アロケータ拡張のムーブ構築が、アロケータ拡張のコピー構築にdecayされないようにした (Clangでも使用できる)


## <a id="throw-exception" href="#throw-exception">ThrowException</a>

- `throw_exception`関数に`boost::source_location`オブジェクトをとるオーバーロードを追加
    - 注 : 例外を無効にして`BOOST_THROW_EXCEPTION`を使用するプロジェクトでは、このオーバーロードが必要になる


## <a id="variant2" href="#variant2">Variant2</a>

- `std::hash`, `boost::hash`のサポートを追加
- `T...`のすべての型がtrivialの場合に`variant<T...>`はtrivialとなる
    - これにより、レジスタ内の関数に渡したり、そこから返したりするパフォーマンスが改善する


## <a id="b2" href="#b2">B2</a>

- B2のリリース[4.2.0](https://github.com/boostorg/build/releases/tag/4.2.0)を含める
- <span style="color:red;">**警告**</span> : B2の4.0.0以降は、bootstrapを実行するためにC++11コンパイラが必要となる。これはB2自身をビルドするために必要なことであり、Boostをビルドするために使用するわけではない



## テスト済みコンパイラ
主要なテストコンパイラ:

- Linux:
    - Clang:
    - GCC:
    - Intel:
    - QCC:
- OS X:
    - Apple Clang:
    - GCC:
    - Intel:
- Windows:
    - GCC, mingw:
    - Visual C++:
- FreeBSD:
    - GCC:
- QNX:
    - QCC:

追加で含まれるテストコンパイラ:

- Linux:
    - Clang:
    - GCC:
    - GCC, C++11:
    - GCC, C++14:
    - Intel:
    - Intel, C++11:
- OS X:
    - Apple Clang:
    - Apple Clang, C++11:
    - Apple Clang, C++14:
    - Clang:
    - Clang, C++11:
    - GCC:
    - Intel:
- Windows:
    - GCC, mingw:
    - Visual C++:
- FreeBSD:
    - GCC:
- QNX:
    - QCC:

## 翻訳
[Akira Takahashi](https://github.com/faithandbrave)

